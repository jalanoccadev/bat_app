import{b as O,e as j,h as k,k as N}from"./chunk-NAD6NYWK.js";import{Aa as S,Ca as y,I,Ja as T,Ka as p,La as u,M as C,Ma as A,Na as R,Oa as s,Pa as n,Qa as i,Ra as l,S as _,T as w,Va as D,Wa as v,Xa as b,ab as a,ba as m,bb as J,cb as x,ha as h,pa as o,wa as c}from"./chunk-SK6YBAZO.js";var f=class r{constructor(t){this.el=t}ngAfterViewInit(){window.bootstrap?.Tooltip&&new window.bootstrap.Tooltip(this.el.nativeElement)}static \u0275fac=function(e){return new(e||r)(c(h))};static \u0275dir=y({type:r,selectors:[["","bsTooltip",""]]})};var g=class r{constructor(t){this.http=t}baseUrl="http://localhost:8080/api/jira";loadIssues(){return this.http.get(`${this.baseUrl}/loadIssues`)}static \u0275fac=function(e){return new(e||r)(C(k))};static \u0275prov=I({token:r,factory:r.\u0275fac,providedIn:"root"})};var G=(r,t)=>t.issueId;function H(r,t){r&1&&(n(0,"div",4)(1,"div",7)(2,"span",8),a(3,"Cargando..."),i()()())}function $(r,t){r&1&&(n(0,"div",5),a(1," Error al cargar datos "),i())}function z(r,t){if(r&1){let e=D();n(0,"tr")(1,"td"),a(2),i(),n(3,"td")(4,"span",10),a(5),i()(),n(6,"td")(7,"span",11),a(8),i()(),n(9,"td")(10,"button",12),l(11,"i",13),i(),n(12,"div",14)(13,"button",15),l(14,"i",16),i(),n(15,"ul",17)(16,"li")(17,"button",18),v("click",function(){let E=_(e).$implicit,M=b(2);return w(M.goToOcd(E))}),l(18,"i",19),a(19," Generar OCD "),i()(),n(20,"li")(21,"button",20),l(22,"i",21),a(23," Generar Checklist L\xEDder T\xE9cnico "),i()(),n(24,"li")(25,"button",20),l(26,"i",22),a(27," Ejecutar Validador Congelamiento "),i()(),n(28,"li")(29,"button",20),l(30,"i",23),a(31," Registrar Checklist "),i()(),n(32,"li")(33,"button",20),l(34,"i",24),a(35," Registrar Calendario "),i()(),n(36,"li")(37,"button",20),l(38,"i",25),a(39," Registrar Conformidad QE "),i()(),n(40,"li")(41,"button",20),l(42,"i",22),a(43," Ejecutar Validador Calendario "),i()()()()()()}if(r&2){let e=t.$implicit,d=b(2);o(2),J(e.issueId),o(2),T("title",e.issueTitle),o(),x(" ",e.issueTitle," "),o(2),s("ngClass",d.badgeClass(e.issueState)),o(),x(" ",e.issueState," "),o(9),s("disabled",!e.allowedActions.includes("GENERAR_OCD")),o(4),s("disabled",!e.allowedActions.includes("CHECKLIST_LT")),o(4),s("disabled",!e.allowedActions.includes("VALIDADOR_CONGELAMIENTO")),o(4),s("disabled",!e.allowedActions.includes("REGISTRAR_CHECKLIST")),o(4),s("disabled",!e.allowedActions.includes("REGISTRAR_CALENDARIO")),o(4),s("disabled",!e.allowedActions.includes("CONFORMIDAD_QE")),o(4),s("disabled",!e.allowedActions.includes("VALIDADOR_CALENDARIO"))}}function K(r,t){if(r&1&&(n(0,"table",6)(1,"thead")(2,"tr")(3,"th"),a(4,"Issue ID"),i(),n(5,"th"),a(6,"T\xEDtulo"),i(),n(7,"th"),a(8,"Estado"),i(),n(9,"th",9),a(10,"Acciones"),i()()(),n(11,"tbody"),A(12,z,44,12,"tr",null,G),i()()),r&2){let e=b();o(12),R(e.issues())}}var V=class r{constructor(t,e){this.jiraService=t;this.router=e}issues=m([]);loading=m(!1);error=m(!1);contador=0;ngOnInit(){this.loadIssues()}loadIssues(){this.loading.set(!0),this.error.set(!1),this.jiraService.loadIssues().subscribe({next:t=>{this.issues.set(t),this.loading.set(!1)},error:()=>{this.error.set(!0),this.loading.set(!1)}})}normalize(t){return t?.trim().toLowerCase()??""}badgeClass(t){if(!t)return"text-bg-light";let e=this.normalize(t);return e==="abierto"?"text-bg-warning":e.includes("doing")?"text-bg-primary":e.includes("done")?"text-bg-secondary":e==="resuelto"?"text-bg-success":"text-bg-light"}goToOcd(t){this.router.navigate(["/ocd",t.appId,t.issueId])}static \u0275fac=function(e){return new(e||r)(c(g),c(N))};static \u0275cmp=S({type:r,selectors:[["app-jira"]],decls:10,vars:3,consts:[[1,"container","mt-4"],[1,"d-flex","justify-content-between","align-items-center","mb-3"],[1,"btn","btn-primary","btn-sm",3,"click"],[1,"bi","bi-arrow-clockwise"],[1,"text-center","my-3"],[1,"text-danger","text-center","my-3"],[1,"table","table-hover"],["role","status",1,"spinner-border","text-primary"],[1,"visually-hidden"],[2,"width","160px"],["bsTooltip","","data-bs-toggle","tooltip","data-bs-placement","bottom",1,"truncate-text"],[1,"badge",3,"ngClass"],[1,"btn","btn-info","btn-sm","me-1"],[1,"bi","bi-info-circle"],[1,"btn-group"],["type","button","data-bs-toggle","dropdown",1,"btn","btn-secondary","btn-sm","dropdown-toggle"],[1,"bi","bi-three-dots-vertical"],[1,"dropdown-menu","dropdown-menu-end"],[1,"dropdown-item",3,"click","disabled"],[1,"bi","bi-file-earmark-plus"],[1,"dropdown-item",3,"disabled"],[1,"bi","bi-check2-square"],[1,"bi","bi-terminal"],[1,"bi","bi-journal-text"],[1,"bi","bi-calendar-plus"],[1,"bi","bi-clipboard-check"]],template:function(e,d){e&1&&(n(0,"div",0)(1,"div",1)(2,"h4"),a(3,"Issues de Jira"),i(),n(4,"button",2),v("click",function(){return d.loadIssues()}),l(5,"i",3),a(6," Recargar "),i()(),p(7,H,4,0,"div",4),p(8,$,2,0,"div",5),p(9,K,14,0,"table",6),i()),e&2&&(o(7),u(d.loading()?7:-1),o(),u(d.error()?8:-1),o(),u(!d.loading()&&!d.error()?9:-1))},dependencies:[j,O,f],styles:[".truncate-text[_ngcontent-%COMP%]{max-width:280px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:inline-block;vertical-align:middle}"]})};export{V as Jira};
