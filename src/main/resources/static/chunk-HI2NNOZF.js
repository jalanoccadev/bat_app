import{b as O,e as j,h as k,k as N}from"./chunk-NAD6NYWK.js";import{Aa as S,Ca as y,I as C,Ja as T,Ka as p,La as u,M as I,Ma as A,Na as R,Oa as s,Pa as n,Qa as t,Ra as l,S as h,T as w,Va as D,Wa as x,Xa as b,ab as a,ba as m,bb as J,cb as v,ha as _,pa as o,wa as c}from"./chunk-SK6YBAZO.js";var f=class r{constructor(i){this.el=i}ngAfterViewInit(){window.bootstrap?.Tooltip&&new window.bootstrap.Tooltip(this.el.nativeElement)}static \u0275fac=function(e){return new(e||r)(c(_))};static \u0275dir=y({type:r,selectors:[["","bsTooltip",""]]})};var g=class r{constructor(i){this.http=i}baseUrl="http://localhost:8080/api/jira";loadIssues(){return this.http.get(`${this.baseUrl}/loadIssues`)}static \u0275fac=function(e){return new(e||r)(I(k))};static \u0275prov=C({token:r,factory:r.\u0275fac,providedIn:"root"})};var G=(r,i)=>i.issueId;function H(r,i){r&1&&(n(0,"div",4)(1,"div",7)(2,"span",8),a(3,"Cargando..."),t()()())}function $(r,i){r&1&&(n(0,"div",5),a(1," Error al cargar datos "),t())}function z(r,i){if(r&1){let e=D();n(0,"tr")(1,"td"),a(2),t(),n(3,"td")(4,"span",12),a(5),t()(),n(6,"td")(7,"span",13),a(8),t()(),l(9,"td"),n(10,"td")(11,"button",14),l(12,"i",15),t(),n(13,"div",16)(14,"button",17),l(15,"i",18),t(),n(16,"ul",19)(17,"li")(18,"button",20),x("click",function(){let E=h(e).$implicit,M=b(2);return w(M.goToOcd(E))}),l(19,"i",21),a(20," Generar OCD "),t()(),n(21,"li")(22,"button",22),l(23,"i",23),a(24," Generar Checklist L\xEDder T\xE9cnico "),t()(),n(25,"li")(26,"button",22),l(27,"i",24),a(28," Ejecutar Validador Congelamiento "),t()(),n(29,"li")(30,"button",22),l(31,"i",25),a(32," Registrar Checklist "),t()(),n(33,"li")(34,"button",22),l(35,"i",26),a(36," Registrar Calendario "),t()(),n(37,"li")(38,"button",22),l(39,"i",27),a(40," Registrar Conformidad QE "),t()(),n(41,"li")(42,"button",22),l(43,"i",24),a(44," Ejecutar Validador Calendario "),t()()()()()()}if(r&2){let e=i.$implicit,d=b(2);o(2),J(e.issueId),o(2),T("title",e.issueTitle),o(),v(" ",e.issueTitle," "),o(2),s("ngClass",d.badgeClass(e.issueState)),o(),v(" ",e.issueState," "),o(10),s("disabled",!e.allowedActions.includes("GENERAR_OCD")),o(4),s("disabled",!e.allowedActions.includes("CHECKLIST_LT")),o(4),s("disabled",!e.allowedActions.includes("VALIDADOR_CONGELAMIENTO")),o(4),s("disabled",!e.allowedActions.includes("REGISTRAR_CHECKLIST")),o(4),s("disabled",!e.allowedActions.includes("REGISTRAR_CALENDARIO")),o(4),s("disabled",!e.allowedActions.includes("CONFORMIDAD_QE")),o(4),s("disabled",!e.allowedActions.includes("VALIDADOR_CALENDARIO"))}}function K(r,i){if(r&1&&(n(0,"table",6)(1,"thead")(2,"tr")(3,"th",9),a(4,"Issue ID"),t(),n(5,"th",10),a(6,"T\xEDtulo"),t(),n(7,"th",9),a(8,"Estado"),t(),n(9,"th",9),a(10,"OCD"),t(),n(11,"th",11),a(12,"Acciones"),t()()(),n(13,"tbody"),A(14,z,45,12,"tr",null,G),t()()),r&2){let e=b();o(14),R(e.issues())}}var V=class r{constructor(i,e){this.jiraService=i;this.router=e}issues=m([]);loading=m(!1);error=m(!1);contador=0;ngOnInit(){this.loadIssues()}loadIssues(){this.loading.set(!0),this.error.set(!1),this.jiraService.loadIssues().subscribe({next:i=>{this.issues.set(i),this.loading.set(!1)},error:()=>{this.error.set(!0),this.loading.set(!1)}})}normalize(i){return i?.trim().toLowerCase()??""}badgeClass(i){if(!i)return"text-bg-light";let e=this.normalize(i);return e==="abierto"?"text-bg-warning":e.includes("doing")?"text-bg-primary":e.includes("done")?"text-bg-secondary":e==="resuelto"?"text-bg-success":"text-bg-light"}goToOcd(i){this.router.navigate(["/ocd",i.appId,i.issueId])}static \u0275fac=function(e){return new(e||r)(c(g),c(N))};static \u0275cmp=S({type:r,selectors:[["app-jira"]],decls:10,vars:3,consts:[[1,"container","mt-4"],[1,"d-flex","justify-content-between","align-items-center","mb-3"],[1,"btn","btn-primary","btn-sm",3,"click"],[1,"bi","bi-arrow-clockwise"],[1,"text-center","my-3"],[1,"text-danger","text-center","my-3"],[1,"table","table-hover"],["role","status",1,"spinner-border","text-primary"],[1,"visually-hidden"],[2,"width","150px","min-width","80px","max-width","400px"],[2,"width","400px","min-width","180px","max-width","500px"],[2,"width","160px"],["bsTooltip","","data-bs-toggle","tooltip","data-bs-placement","bottom",1,"truncate-text"],[1,"badge",3,"ngClass"],[1,"btn","btn-info","btn-sm","me-1"],[1,"bi","bi-info-circle"],[1,"btn-group"],["type","button","data-bs-toggle","dropdown",1,"btn","btn-secondary","btn-sm","dropdown-toggle"],[1,"bi","bi-three-dots-vertical"],[1,"dropdown-menu","dropdown-menu-end"],[1,"dropdown-item",3,"click","disabled"],[1,"bi","bi-file-earmark-plus"],[1,"dropdown-item",3,"disabled"],[1,"bi","bi-check2-square"],[1,"bi","bi-terminal"],[1,"bi","bi-journal-text"],[1,"bi","bi-calendar-plus"],[1,"bi","bi-clipboard-check"]],template:function(e,d){e&1&&(n(0,"div",0)(1,"div",1)(2,"h4"),a(3,"Issues de Jira"),t(),n(4,"button",2),x("click",function(){return d.loadIssues()}),l(5,"i",3),a(6," Recargar "),t()(),p(7,H,4,0,"div",4),p(8,$,2,0,"div",5),p(9,K,16,0,"table",6),t()),e&2&&(o(7),u(d.loading()?7:-1),o(),u(d.error()?8:-1),o(),u(!d.loading()&&!d.error()?9:-1))},dependencies:[j,O,f],styles:[".truncate-text[_ngcontent-%COMP%]{max-width:500px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:inline-block;vertical-align:middle}"]})};export{V as Jira};
